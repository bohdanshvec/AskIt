<% provide :page_title, t('.title') %>

<% currently_at(t('menu.questions')) %>

<div class='m-3'>

  <div class='card p-2'>
    <div class="mb-2">
      <h1><%= @question.title %></h1>
    </div>

    <div class="my-2">
      <time datatime="<% @question.formatted_created_at %>">
        <%= @question.formatted_created_at %>
      </time>
    </div>

    <div class="my-2">
      <%= sanitize(@question.body) %>
    </div>

    <div class='mb-3'>
      <%= @question.user.gravatar %>
      <%= @question.user.name_or_email %>
    </div>

    <div class='mt-3'>
      <% if policy(@question).edit? %>
        <%= link_to t('global.button.edit'), edit_question_path(@question), class: "btn btn-primary"  %>
      <% end %>

      <% if policy(@question).destroy? %>
        <%= link_to t('global.button.destroy'), question_path(@question), data: {turbo_method: :delete, turbo_confirm: t('global.button.confirm') }, class: "btn btn-danger"  %>
      <% end %>
    </div>
  </div>

  <div class='mt-2'>
    <%= render 'comments/commentable', commentable: @question, comment: @comment, 
      html_id: 'questionComments' %>
  </div>

  <hr>

  <% if policy(:answer).new? %>
    <h2><%= t('.write_answer') %></h2>

    <%= render 'answers/form' %>
  <% end %>

  <h2 class="mt-5"><%= t('.answers') %> :</h2>

  <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>

    <%= render partial: 'answers/answer', collection: @answers, as: :answer, locals: {question: @question} %>

  <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>

</div>


